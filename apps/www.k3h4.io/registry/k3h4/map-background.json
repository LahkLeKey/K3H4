{
  "name": "map-background",
  "type": "registry:ui",
  "dependencies": {
    "maplibre-gl": "^5.0.0"
  },
  "files": [
    {
      "name": "map-background.tsx",
      "type": "registry:ui",
      "path": "@/components/ui/map-background.tsx",
      "content": "import { useEffect, useRef } from \"react\"\r\nimport maplibregl, { type Map } from \"maplibre-gl\"\r\n\r\nimport \"maplibre-gl/dist/maplibre-gl.css\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport type MapBackgroundProps = {\r\n    className?: string\r\n    /** Override the default Hastings, MN center. */\r\n    center?: [number, number]\r\n    /** Zoom level; defaults to a city overview. */\r\n    zoom?: number\r\n    /** Disable user interaction when you want a fixed backdrop. */\r\n    interactive?: boolean\r\n}\r\n\r\nconst DEFAULT_CENTER: [number, number] = [-92.851, 44.743]\r\nconst DEFAULT_ZOOM = 12\r\n\r\nexport function MapBackground({\r\n    className,\r\n    center = DEFAULT_CENTER,\r\n    zoom = DEFAULT_ZOOM,\r\n    interactive = false,\r\n}: MapBackgroundProps) {\r\n    const mapRef = useRef<HTMLDivElement | null>(null)\r\n    const instanceRef = useRef<Map | null>(null)\r\n\r\n    useEffect(() => {\r\n        if (!mapRef.current) return\r\n\r\n        instanceRef.current = new maplibregl.Map({\r\n            container: mapRef.current,\r\n            style: \"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json\",\r\n            center,\r\n            zoom,\r\n            interactive,\r\n            attributionControl: false,\r\n        })\r\n\r\n        instanceRef.current.on(\"error\", (event) => {\r\n            // Surface map errors to the console to debug missing tiles/styles.\r\n            console.warn(\"MapLibre error\", event?.error ?? event)\r\n        })\r\n\r\n        // Subtle accent stroke to match the theme palette.\r\n        instanceRef.current.once(\"load\", () => {\r\n            const map = instanceRef.current\r\n            if (!map) return\r\n\r\n            const paintUpdates: Array<\r\n                [layer: string, property: string, value: string]\r\n            > = [\r\n                    [\"water\", \"fill-color\", \"hsl(200, 80%, 68%)\"],\r\n                    [\"landuse\", \"fill-color\", \"hsl(205, 33%, 96%)\"],\r\n                    [\"park\", \"fill-color\", \"hsl(158, 38%, 28%)\"],\r\n                    [\"waterway\", \"line-color\", \"hsl(200, 75%, 58%)\"],\r\n                    [\"road\", \"line-color\", \"hsl(158, 38%, 28%)\"],\r\n                ]\r\n\r\n            paintUpdates.forEach(([layer, property, value]) => {\r\n                if (map.getLayer(layer)) {\r\n                    map.setPaintProperty(layer, property, value)\r\n                }\r\n            })\r\n        })\r\n\r\n        return () => {\r\n            instanceRef.current?.remove()\r\n            instanceRef.current = null\r\n        }\r\n    }, [center, zoom, interactive])\r\n\r\n    return (\r\n        <div className={cn(\"map-shell\", className)}>\r\n            <div\r\n                ref={mapRef}\r\n                className={cn(\r\n                    \"map-shell__map\",\r\n                    \"[&_.maplibregl-canvas-container]:!h-full [&_.maplibregl-canvas-container]:!w-full\",\r\n                    \"[&_.maplibregl-canvas]:rounded-[1.25rem]\"\r\n                )}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n"
    }
  ]
}